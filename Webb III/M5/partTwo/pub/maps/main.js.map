{"version":3,"sources":["main.js"],"names":["courseListTable","document","getElementById","codeInput","nameInput","progressionInput","syllabusInput","formMessage","restAPIlink","apiLinkWithCode","window","location","search","getCourseList","checkPage","fetch","then","response","json","data","forEach","courses","innerHTML","code","name","progression","syllabus","course","value","addCourse","event","preventDefault","method","body","JSON","stringify","ok","message","classList","add","catch","error","console","log","editCourse","deleteCourse","confirm","substring","addEventListener"],"mappings":"AAAA,aAGA,IAAAA,gBAAAC,SAAAC,eAAA,mBAGAC,UAAAF,SAAAC,eAAA,QACAE,UAAAH,SAAAC,eAAA,QACAG,iBAAAJ,SAAAC,eAAA,eACAI,cAAAL,SAAAC,eAAA,YAGAK,YAAAN,SAAAC,eAAA,eAGAM,YAAA,+EAGAC,gBAAAD,YAAAE,OAAAC,SAAAC,OAeA,SAAAC,gBAEA,GAAAC,UACAC,MAAAP,aACAQ,MAAAC,GAAAA,EAAAC,SACAF,MAAAG,IACAA,EAAAC,SAAAC,IACArB,gBAAAsB,WAAA,yDAEAD,EAAAE,wCACAF,EAAAG,wCACAH,EAAAI,wDACAJ,EAAAK,wFACAL,EAAAE,wDAAAF,EAAAE,2FAUAR,MAAAN,iBACAO,MAAAC,GAAAA,EAAAC,SACAF,MAAAG,IACAA,EAAAC,SAAAO,IACAxB,UAAAyB,MAAAD,EAAAJ,KACAnB,UAAAwB,MAAAD,EAAAH,KACAnB,iBAAAuB,MAAAD,EAAAF,YACAnB,cAAAsB,MAAAD,EAAAD,eAWA,SAAAG,UAAAC,GAGAA,EAAAC,iBAGA,IAKAJ,EAAA,CAAAJ,KALApB,UAAAyB,MAKAJ,KAJApB,UAAAwB,MAIAH,YAHApB,iBAAAuB,MAGAF,SAFApB,cAAAsB,OAMAb,MAAAP,YAAA,CACAwB,OAAA,OACAC,KAAAC,KAAAC,UAAAR,KAEAX,MAAAC,GAAAA,EAAAC,SAEAF,MAAA,SAAAC,GAEAA,EAAAmB,GAgBAvB,gBAdA,QAAAI,EAAAoB,SACA9B,YAAA+B,UAAAC,IAAA,SACAhC,YAAAe,UAAA,yBACA,QAAAL,EAAAoB,SACA9B,YAAA+B,UAAAC,IAAA,SACAhC,YAAAe,UAAA,8BAEA,eAAAL,EAAAoB,UACA9B,YAAA+B,UAAAC,IAAA,SACAhC,YAAAe,UAAA,8DASAkB,OAAAC,IACAC,QAAAC,IAAA,YAAAF,MAOA,SAAAG,aAGA,IAKAjB,EAAA,CAAAJ,KALApB,UAAAyB,MAKAJ,KAJApB,UAAAwB,MAIAH,YAHApB,iBAAAuB,MAGAF,SAFApB,cAAAsB,OAKAb,MAAAN,gBAAA,CACAuB,OAAA,MACAC,KAAAC,KAAAC,UAAAR,KAEAX,MAAAC,GAAAA,EAAAC,SAEAF,MAAAG,IACAA,EAAAC,SAAAC,IACAR,sBAGA2B,OAAAC,IACAC,QAAAC,IAAA,UAAAF,MAMA,SAAAI,eAKA,GAFAC,QAAA,8CAKA/B,MAAAN,gBAAA,CACAuB,OAAA,SACAC,KAAAC,KAAAC,UAAAzB,OAAAC,SAAAC,OAAAmC,UAAA,MAEA/B,MAAAC,GAAAA,EAAAC,SACAF,MAAAG,IACAT,OAAAC,SAAA,gBAEA6B,OAAAC,IACAC,QAAAC,IAAA,UAAAF,MAtJA/B,OAAAsC,iBAAA,OAAAnC,eAKA,GAAAC,YACAb,SAAAC,eAAA,cAAA8C,iBAAA,SAAAJ,YACA3C,SAAAC,eAAA,aAAA8C,iBAAA,QAAAH","file":"../javascript/main.js","sourcesContent":["\"use strict\";\r\n\r\n//Get box for course list\r\nlet courseListTable = document.getElementById(\"courseListTable\");\r\n\r\n//Get input value index page\r\nlet codeInput = document.getElementById('code');\r\nlet nameInput = document.getElementById('name');\r\nlet progressionInput = document.getElementById('progression');\r\nlet syllabusInput = document.getElementById('syllabus');\r\n\r\n//Form message box\r\nlet formMessage = document.getElementById('formMassage');\r\n\r\n//Rest link\r\nlet restAPIlink = \"https://studenter.miun.se/~emho2003/writeable/DT173G-m5/partTwo/pub/rest.php\"\r\n\r\n//Get api link with code values from url\r\nlet apiLinkWithCode = restAPIlink + window.location.search;\r\n\r\n//Händelselyssnare\r\nwindow.addEventListener(\"load\", getCourseList);\r\n//document.getElementById(\"addCourse\").addEventListener(\"submit\", addCourse(event));\r\n\r\n\r\n//Use to remove \"error\" console messages, checkpage value is for now decides on html-pages\r\nif (checkPage == false) {\r\n    document.getElementById(\"editCourse\").addEventListener(\"submit\", editCourse);\r\n    document.getElementById(\"deleteBtn\").addEventListener(\"click\", deleteCourse);\r\n}\r\n\r\n\r\n//Print out course list on index page\r\nfunction getCourseList() {\r\n\r\n    if (checkPage == true) {\r\n        fetch(restAPIlink)\r\n        .then(response => response.json())\r\n            .then(data => {\r\n                data.forEach(courses => {\r\n                    courseListTable.innerHTML += `\r\n                    <tr> \r\n                    <td> ${courses.code} </td>\r\n                    <td> ${courses.name} </td>\r\n                    <td> ${courses.progression} </td>\r\n                    <td> <a href=\"${courses.syllabus}\" target=\"_blank\"> Webblänk </a> </td>\r\n                    <td> <button id=\"${courses.code}\"  onclick=\"window.location.href='edit.html?code=${courses.code}';\" > Hantera </button> </td>\r\n                    </tr>\r\n                    `;\r\n                })\r\n            })\r\n\r\n    //If url have a code, user is probably/hopefully on edit course page\r\n    } else {\r\n\r\n        //Get course info\r\n        fetch(apiLinkWithCode)\r\n        .then(response => response.json())\r\n            .then(data => {\r\n                data.forEach(course => {\r\n                    codeInput.value = course.code;\r\n                    nameInput.value = course.name;\r\n                    progressionInput.value = course.progression;\r\n                    syllabusInput.value = course.syllabus;\r\n                })\r\n            })\r\n      \r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n//Add a new course\r\nfunction addCourse(event) {\r\n\r\n    //Stop form to reload page\r\n    event.preventDefault();\r\n    \r\n    //Read the values from input\r\n    let code = codeInput.value;\r\n    let name = nameInput.value;\r\n    let progression = progressionInput.value;\r\n    let syllabus = syllabusInput.value;\r\n\r\n    let course = {'code': code, 'name': name, 'progression': progression, 'syllabus': syllabus}; \r\n    \r\n\r\n    //Connect to database\r\n    fetch(restAPIlink, {\r\n        method: 'POST', \r\n        body: JSON.stringify(course),\r\n    })\r\n    .then(response => response.json())\r\n  \r\n        .then(function(response) {\r\n            //Check so information is correct\r\n            if (!response.ok) {\r\n\r\n                if(response.message == 'code') {\r\n                    formMessage.classList.add(\"error\");\r\n                    formMessage.innerHTML = \"Kurskoden är felaktig\";\r\n                } else if(response.message == 'name') {\r\n                    formMessage.classList.add(\"error\");\r\n                    formMessage.innerHTML = \"Kursnamnet är inte korrekt\";\r\n\r\n                } else if(response.message == 'progression') {\r\n                    formMessage.classList.add(\"error\");\r\n                    formMessage.innerHTML = \"Progressaionen är fel, <br> ange endast stort A eller B\";\r\n                } \r\n\r\n                //If everything is right, get the updated list\r\n            }  else {\r\n                getCourseList();\r\n            }\r\n        })\r\n     \r\n        .catch(error => {\r\n            console.log('Message: ', error)\r\n        })\r\n\r\n\r\n} \r\n\r\n//To edit a course on edit page\r\nfunction editCourse() {\r\n\r\n    //Collect value from input, function getCourseList print them out\r\n    let code = codeInput.value;\r\n    let name = nameInput.value;\r\n    let progression = progressionInput.value;\r\n    let syllabus = syllabusInput.value;\r\n\r\n    let course = {'code': code, 'name': name, 'progression': progression, 'syllabus': syllabus}; \r\n\r\n    //Connect to database\r\n    fetch(apiLinkWithCode, {\r\n        method: 'PUT', \r\n        body: JSON.stringify(course),\r\n    })\r\n    .then(response => response.json())\r\n    \r\n        .then(data => {\r\n            data.forEach(courses => {\r\n                getCourseList();\r\n            })\r\n        })\r\n        .catch(error => {\r\n            console.log('Error: ', error)\r\n        })\r\n\r\n}\r\n\r\n//To delete a course\r\nfunction deleteCourse() {\r\n\r\n    //To prevent mistake, do alert before\r\n    let alertReslut = confirm(\"Är du säker på att du vill radera kursen?\");\r\n\r\n    if (alertReslut == true) {\r\n    \r\n        //Connect to database\r\n        fetch(apiLinkWithCode, {\r\n            method: 'DELETE', \r\n            body: JSON.stringify(window.location.search.substring(6)),\r\n        })\r\n        .then(response => response.json())\r\n            .then(data => {\r\n                window.location=\"index.html\";\r\n            })\r\n            .catch(error => {\r\n                console.log('Error: ', error)\r\n            })\r\n    \r\n    } \r\n\r\n}"]}